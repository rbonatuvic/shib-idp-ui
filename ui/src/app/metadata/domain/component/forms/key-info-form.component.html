<form [formGroup]="form" role="form">
    <div class="row" formGroupName="securityInfo">
        <div class="col-xl-6 form-section">
            <fieldset aria-label="Is there a X509 certificate? Radio choice">
                <div class="form-group">
                    <div class="row">
                        <label for="x509CertificateAvailableRadioGroup">
                            <translate key="label.is-there-a-x509-certificate">Is there a X509 Certificate?</translate>
                        </label>&nbsp;
                        <span>
                            <ng-template #tooltipIsThereAX509Certificate>
                                <translate key="tooltip.authentication-requests-signed">Is there a X509 Certificate popover</translate>
                            </ng-template>
                            <i class="info-icon fa fa-fw fa-info-circle text-primary fa-lg"
                               [ngbPopover]="tooltipIsThereAX509Certificate"
                               i18n-aria-label="@@tooltip.instruction"
                               aria-label="Information icon - press spacebar to read additional information for this form field"></i>
                        </span>
                    </div>
                    <div id="x509CertificateAvailableRadioGroup" role="radiogroup" aria-activedescendant="x509CertificateAvailableNo" tabindex="0">
                        <div class="form-check form-check-inline">
                            <input disableValidation="true" class="form-check-input" type="radio" formControlName="x509CertificateAvailable" name="x509CertificateAvailable"
                                [value]="true" id="x509CertificateAvailableTrue" aria-checked="false" role="radio">
                            <label class="form-check-label" translate="label.yes" for="x509CertificateAvailableTrue">Yes</label>
                        </div>
                        <div class="form-check form-check-inline">
                            <input disableValidation="true" class="form-check-input" type="radio" tabindex="0" formControlName="x509CertificateAvailable"
                                name="x509CertificateAvailable" id="x509CertificateAvailableFalse" [value]="false" aria-checked="true" role="radio">
                            <label class="form-check-label" translate="label.no" for="x509CertificateAvailableFalse">No</label>
                        </div>
                    </div>
                </div>
            </fieldset>
            <div class="form-group">
                <fieldset aria-label="Should authentication requests be signed? Radio choice">
                    <div class="row">
                        <label for="authenticationRequestsSignedRadioGroup">
                            <translate key="label.authentication-requests-signed">Authentication Requests Signed?</translate>
                        </label>&nbsp;
                        <span>
                            <ng-template #tooltipAuthenticationRequestsSigned>
                                <translate key="tooltip.authentication-requests-signed">Authentication Requests Signed popover</translate>
                            </ng-template>
                        <i class="info-icon fa fa-fw fa-info-circle text-primary fa-lg"
                           [ngbPopover]="tooltipAuthenticationRequestsSigned"
                           i18n-aria-label="@@tooltip.instruction"
                           aria-label="Information icon - press spacebar to read additional information for this form field"></i>
                        </span>
                    </div>
                    <div id="authenticationRequestsSignedRadioGroup" role="radiogroup" aria-activedescendant="authenticationRequestsSignedNo" tabindex="0">
                        <div class="form-check form-check-inline">
                            <input disableValidation="true" class="form-check-input" type="radio" tabindex="0" formControlName="authenticationRequestsSigned"
                                name="authenticationRequestsSigned" id="authenticationRequestsSignedTrue" [value]="true" aria-checked="false" role="radio">
                            <label class="form-check-label" translate="label.yes" for="authenticationRequestsSignedTrue">Yes</label>
                        </div>
                        <div class="form-check form-check-inline">
                            <input disableValidation="true" class="form-check-input" type="radio" tabindex="0" formControlName="authenticationRequestsSigned"
                                name="authenticationRequestsSigned" id="authenticationRequestsSignedFalse" [value]="false" aria-checked="true" role="radio">
                            <label class="form-check-label" translate="label.no" for="authenticationRequestsSignedFalse">No</label>
                        </div>
                    </div>
                </fieldset>
            </div>
            <div class="form-group">
                <fieldset aria-label="Do you want the assertions signed? Radio choice">
                    <div class="row">
                        <label>
                            <translate key="label.want-assertions-signed">Want Assertions Signed?</translate>
                        </label>&nbsp;
                        <span>
                            <ng-template #tooltipWantAssertionsSigned>
                                <translate key="tooltip.want-assertions-signed">Want Assertions Signed</translate>
                            </ng-template>
                            <i class="info-icon fa fa-fw fa-info-circle text-primary fa-lg"
                                [ngbPopover]="tooltipWantAssertionsSigned"
                                i18n-aria-label="@@tooltip.instruction"
                                aria-label="Information icon - press spacebar to read additional information for this form field"></i>
                        </span>
                    </div>
                    <div id="wantAssertionsSignedRadioGroup" role="radiogroup" aria-activedescendant="wantAssertionsSignedNo" tabindex="0">
                        <div class="form-check form-check-inline">
                            <input disableValidation="true" class="form-check-input" type="radio" tabindex="0" formControlName="wantAssertionsSigned"
                                name="wantAssertionsSigned" id="wantAssertionsSignedTrue" [value]="true" aria-checked="false" role="radio">
                            <label class="form-check-label" translate="label.yes" for="wantAssertionsSignedTrue">Yes</label>
                        </div>
                        <div class="form-check form-check-inline">
                            <input disableValidation="true" class="form-check-input" type="radio" tabindex="0" formControlName="wantAssertionsSigned"
                                name="wantAssertionsSigned" name="wantAssertionsSigned" id="wantAssertionsSignedFalse" [value]="false" aria-checked="true" role="radio">
                            <label class="form-check-label" translate="label.no" for="wantAssertionsSignedFalse">No</label>
                        </div>
                    </div>
                </fieldset>
            </div>
        </div>
        <fieldset class="col form-section">
            <p>
                <translate key="label.x509-certificates">X509 Certificates: </translate>
                <button class="btn btn-success btn-sm" (click)="addCert()" [disabled]="!(hasCert$ | async)" translate="action.add-certificate" aria-label="Add certificate to accordion group" role="button">Add Certificate</button>
            </p>
            <div formArrayName="x509Certificates" class="bg-light border rounded p-4" *ngIf="x509Certificates.length">
                <ul class="list-group" aria-label="x509 Certificates accordion"  tabindex="0" role="presentation">
                    <li *ngFor="let cert of x509Certificates.controls; let i=index;"
                        [formGroupName]="i"
                        class="list-group-item"
                        [attr.aria-label]="'x509 certificate information accordion item for ' + cert.get('name').value"
                        #acc>
                        <div class="clearfix">
                            <div class="row" (click)="acc.isHidden = !acc.isHidden" (keydown.space)="acc.isHidden = !acc.isHidden" [id]="'certAccordion' + i" aria-expanded="true" [attr.aria-controls]="'certContent' + i" role="button">
                                <div class="col-sm-10">
                                    <i class="fa fa-fw" [ngClass]="{'fa-chevron-right': acc.isHidden, 'fa-chevron-down': !acc.isHidden}"></i>
                                    <span tabindex="0" role="heading" aria-level="3">
                                        <ng-container *ngIf="cert.get('name').value">{{ cert.get('name').value }}</ng-container>
                                        <ng-container *ngIf="!cert.get('name').value" translate="label.new-cert">New Certificate</ng-container>
                                        <small *ngIf="cert.get('type').value">
                                            (<i18n-text [key]="cert.get('type').value"></i18n-text>)
                                        </small>
                                    </span>
                                </div>
                                <div class="col-sm-2 text-right">
                                    <button class="btn btn-link btn-sm text-danger" (click)="removeCert(i)" aria-label="Delete certificate" role="button">
                                        <i class="fa fa-fw fa-trash fa-lg"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                        <div class="collapse" [ngClass]="{'show': !acc.isHidden}"  [id]="'certContent' + i" [attr.aria-labelledby]="'certAccordion' + i" role="region">
                            <hr />
                            <div class="form-group">
                                <div class="row">
                                    <label [for]="'name-' + i" class="col-sm-10">
                                        <span>
                                             <translate key="label.certificate-name-display-only">Certificate Name (Display Only)</translate>
                                             <i class="fa fa-fw fa-asterisk text-danger" aria-hidden="true"></i>
                                        </span>
                                    </label>
                                    <span class="col-sm-2 text-right">
                                        <ng-template #tooltipCertificateName>
                                            <translate key="tooltip.certificate-name">Certificate Name Popover</translate>
                                        </ng-template>
                                        <i class="info-icon fa fa-fw fa-info-circle text-primary fa-lg"
                                           [ngbPopover]="tooltipCertificateName"
                                           i18n-aria-label="@@tooltip.instruction"
                                           aria-label="Information icon - press spacebar to read additional information for this form field"></i>
                                    </span>
                                </div>
                                <input [id]="'name-' + i" type="text" class="form-control" placeholder="" formControlName="name" aria-label="x509 certificate name" role="textbox" />
                            </div>
                            <div class="form-group">
                                <fieldset aria-label="What is the type of ceritifcate? Radio choice">
                                    <div class="row">
                                        <label [for]="'type-' + i" class="col-sm-10">
                                            <span>
                                                <translate key="label.type">Type</translate>
                                                <i class="fa fa-fw fa-asterisk text-danger" aria-hidden="true"></i>
                                            </span>
                                        </label>
                                        <span class="col-sm-2 text-right">
                                            <ng-template #tooltipCertificateType>
                                                <translate key="tooltip.certificate-type">Certificate Type Popover</translate>
                                            </ng-template>
                                        <i class="info-icon fa fa-fw fa-info-circle text-primary fa-lg"
                                           [ngbPopover]="tooltipCertificateType"
                                           i18n-aria-label="@@tooltip.instruction"
                                           aria-label="Information icon - press spacebar to read additional information for this form field"></i>
                                        </span>
                                    </div>
                                    <div id="certTypeRadioGroup" role="radiogroup" tabindex="0">
                                        <div *ngFor="let type of types; let t=index;" class="form-check form-check-inline">
                                            <input disableValidation="true" id="type-{{ i }}-{{ t }}" class="form-check-input" type="radio" tabindex="0" formControlName="type"
                                                [value]="type" role="radio">
                                            <label class="form-check-label" for="type-{{ i }}-{{ t }}">
                                                <i18n-text [key]="type"></i18n-text>
                                            </label>
                                        </div>
                                    </div>
                                </fieldset>
                            </div>
                            <div class="form-group">
                                <div class="row">
                                    <label [for]="'cert-' + i" class="col-sm-10">
                                        <span>
                                            <translate key="label.certificate">Certificate</translate>
                                            <i class="fa fa-fw fa-asterisk text-danger" aria-hidden="true"></i>
                                        </span>
                                    </label>
                                    <span class="col-sm-2 text-right">
                                        <ng-template #tooltipCertificateBody>
                                            <translate key="tooltip.certificate">Certificate Popover</translate>
                                        </ng-template>
                                            <i class="info-icon fa fa-fw fa-info-circle text-primary fa-lg"
                                               [ngbPopover]="tooltipCertificateBody"
                                               i18n-aria-label="@@tooltip.instruction"
                                               aria-label="Information icon - press spacebar to read additional information for this form field"></i>
                                    </span>
                                </div>
                                <textarea [id]="'cert-' + i" class="form-control" placeholder="" formControlName="value" rows="10" [disableDefaults]="true" role="textbox" aria-multiline="true"></textarea>
                            </div>
                        </div>
                    </li>
                </ul>
            </div>
        </fieldset>
    </div>
</form>
