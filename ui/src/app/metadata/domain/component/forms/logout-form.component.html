<form [formGroup]="form" role="form">
    <div class="row">
        <fieldset class="col col-xl-6 form-section">
            <p>
                <translate key="label.logout-endpoints">Logout Endpoints: </translate>
                <button class="btn btn-success btn-sm" (click)="addEndpoint()" translate="action.add-endpoint" aria-label="Add logout endpoint to accordion group">Add Endpoint</button>
            </p>
            <div formArrayName="logoutEndpoints" class="bg-light border rounded p-4" *ngIf="logoutEndpoints.length">
                <ul class="list-group" id="logoutAccordionGroup" aria-label="Logout endpoint accordion group" role="presentation" tabindex="0">
                    <li *ngFor="let endpoint of logoutEndpoints.controls; let i=index;"
                        [formGroupName]="i"
                        class="list-group-item"
                        [attr.aria-label]="'Logout endpoint information accordion item for ' + endpoint.get('url').value"
                        #acc>
                        <div class="clearfix">
                            <div class="row" (click)="acc.isHidden = !acc.isHidden" (keydown.space)="acc.isHidden = !acc.isHidden" [id]="'logoutAccordion' + i" aria-expanded="true" [attr.aria-controls]="'logoutContent' + i" role="button">
                                <div class="col-sm-10">
                                    <i class="fa fa-fw" [ngClass]="{'fa-chevron-right': acc.isHidden, 'fa-chevron-down': !acc.isHidden}"></i>
                                    <span tabindex="0" role="heading" aria-level="3">
                                        <ng-container *ngIf="endpoint.get('url').value">{{ endpoint.get('url').value }}</ng-container>
                                        <ng-container *ngIf="!endpoint.get('url').value" translate="label.new-endpoint">New Endpoint</ng-container>
                                    </span>
                                </div>
                                <span class="col-sm-2 text-right">
                                    <button class="btn btn-link btn-sm text-danger" (click)="removeEndpoint(i)" aria-label="Delete logout endpoint" role="button">
                                        <i class="fa fa-fw fa-trash fa-lg"></i>
                                    </button>
                                </span>
                            </div>
                        </div>
                        <div class="collapse" [ngClass]="{'show': !acc.isHidden}" [id]="'logoutContent' + i" [attr.aria-labelledby]="'logoutAccordion' + i" role="region">
                            <hr />
                            <div class="form-group">
                                <div class="row">
                                    <label [for]="'url-' + i" class="col-sm-10">
                                        <translate key="label.url">URL</translate>
                                    </label>
                                    <span class="col-sm-2 text-right">
                                        <ng-template #tooltipLogoutEndpointsUrl>
                                            <translate key="tooltip.logout-endpoints-url">Logout Endpoints Url popover</translate>
                                        </ng-template>
                                        <i class="info-icon fa fa-fw fa-info-circle text-primary fa-lg"
                                           [ngbPopover]="tooltipLogoutEndpointsUrl"
                                           i18n-aria-label="@@tooltip.instruction"
                                           aria-label="Information icon - press spacebar to read additional information for this form field"></i>
                                    </span>
                                </div>
                                <input [id]="'url-' + i" type="text" class="form-control" placeholder="" formControlName="url" aria-label="Logout endpoint URL" role="textbox" />
                                <small class="form-text text-danger" *ngIf="endpoint.get('url').hasError('pattern')">Must be a valid URL</small>
                            </div>
                            <div class="form-group">
                                <div class="row">
                                    <label [for]="'binding-' + i" class="col-sm-10">
                                        <translate key="label.binding-types">Binding Type</translate>
                                    </label>
                                    <span class="col-sm-2 text-right">
                                        <ng-template #tooltipLogoutEndpointsBindingType>
                                            <translate key="tooltip.logout-endpoints-binding-type">Logout Endpoints Binding Type popover</translate>
                                        </ng-template>
                                    <i class="info-icon fa fa-fw fa-info-circle text-primary fa-lg"
                                       [ngbPopover]="tooltipLogoutEndpointsBindingType"
                                       i18n-aria-label="@@tooltip.instruction"
                                       aria-label="Information icon - press spacebar to read additional information for this form field"></i>
                                    </span>
                                </div>
                                <select [id]="'binding-' + i" class="form-control" formControlName="bindingType" aria-label="Logout binding type dropdown" role="listbox">
                                    <option disabled selected [ngValue]="null" hidden role="option" translate="label.select-binding">Select Binding Type</option>
                                    <option *ngFor="let opt of bindingTypes; let i=index;" [value]="opt" [attr.aria-label]="opt" role="option">{{ opt }}</option>
                                </select>
                            </div>
                        </div>
                    </li>
                </ul>
            </div>
        </fieldset>
    </div>
</form>
