<form [formGroup]="form" role="form">
    <div class="row">
        <fieldset class="form-section col-xl-6">
            <div class="form-group">
                <div class="row">
                    <label for="serviceProviderName" class="col-sm-10">
                        <span>
                            <translate key="label.service-provider-name-dashboard-display-only">Service Provider Name (Dashboard Display Only)</translate>
                            <i class="fa fa-fw fa-asterisk text-danger" aria-hidden="true"></i>
                        </span>
                    </label>
                    <span class="col-sm-2 text-right">
                        <ng-template #tooltipServiceProviderNameDashboardDisplayOnly>
                            <translate key="tooltip.service-provider-name-dashboard-display-only">Service Provider Name (Dashboard Display Only) popover</translate>
                        </ng-template>
                        <i class="info-icon fa fa-fw fa-info-circle text-primary fa-lg"
                           [ngbPopover]="tooltipServiceProviderNameDashboardDisplayOnly"
                           i18n-aria-label="@@tooltip.instruction"
                           aria-label="Information icon - press spacebar to read additional information for this form field"></i>
                    </span>
                </div>
                <input type="text"
                       id="serviceProviderName"
                       class="form-control"
                       placeholder=""
                       formControlName="serviceProviderName"
                       role="textbox" />
            </div>
            <div class="form-group">
                <div class="row">
                    <label for="entityId" class="col-sm-10">
                        <span>
                            <translate key="label.service-provider-entity-id">Service Provider Entity ID</translate>
                            <i class="fa fa-fw fa-asterisk text-danger" aria-hidden="true"></i>
                        </span>
                    </label>
                    <span class="col-sm-2 text-right">
                        <ng-template #tooltipServiceProviderEntityID>
                            <translate key="tooltip.service-provider-entity-id">Service Provider Entity ID popover</translate>
                        </ng-template>
                        <i class="info-icon fa fa-fw fa-info-circle text-primary fa-lg"
                           [ngbPopover]="tooltipServiceProviderEntityID"
                           i18n-aria-label="@@tooltip.instruction"
                           aria-label="Information icon - press spacebar to read additional information for this form field"></i>
                    </span>
                </div>
                <input type="text"
                       id="entityId"
                       class="form-control"
                       placeholder=""
                       formControlName="entityId"
                       role="textbox"/>
            </div>
            <div class="form-group">
                <div class="custom-control custom-checkbox custom-control-inline custom-control-reverse" for="serviceEnabled">
                    <input disableValidation="true" class="custom-control-input" type="checkbox" formControlName="serviceEnabled" id="serviceEnabled" name="serviceEnabled" role="checkbox">
                    <label class="custom-control-label" for="serviceEnabled" aria-label="Enable this service?">
                        <translate key="label.enable-this-service">Enable this service?</translate>
                    </label>
                </div>
            </div>
            <div formGroupName="organization">
                <div class="form-group clearfix">
                    <div class="row">
                        <label for="name" class="col-sm-10">
                            <span>
                                <translate key="label.organization-name">Organization Name</translate>
                                <i class="fa fa-fw fa-asterisk text-danger" aria-hidden="true" *ngIf="hasValue$ | async"></i>
                            </span>
                        </label>
                        <span class="col-sm-2 text-right">
                            <ng-template #tooltipOrganizationName>
                                <translate key="tooltip.organization-name">Organization Name popover</translate>
                            </ng-template>
                            <i class="info-icon fa fa-fw fa-info-circle text-primary fa-lg"
                               [ngbPopover]="tooltipOrganizationName"
                               i18n-aria-label="@@tooltip.instruction"
                               aria-label="Information icon - press spacebar to read additional information for this form field"></i>
                        </span>
                    </div>
                    <input type="text"
                           id="name"
                           class="form-control"
                           placeholder=""
                           formControlName="name"
                           role="textbox" />
                </div>
                <div class="form-group">
                    <div class="row">
                        <label for="displayName" class="col-sm-10">
                            <span>
                                <translate key="label.organization-display-name">Organization Display Name</translate>
                                <i class="fa fa-fw fa-asterisk text-danger" aria-hidden="true" *ngIf="hasValue$ | async"></i>
                            </span>
                        </label>
                        <span class="col-sm-2 text-right">
                            <ng-template #tooltipOrganizationDisplayName>
                                <translate translate="tooltip.organization-display-name">Organization Display Name popover</translate>
                            </ng-template>
                            <i class="info-icon fa fa-fw fa-info-circle text-primary fa-lg"
                               [ngbPopover]="tooltipOrganizationDisplayName"
                               i18n-aria-label="@@tooltip.instruction"
                               aria-label="Information icon - press spacebar to read additional information for this form field"></i>
                        </span>
                    </div>
                    <input type="text"
                           id="displayName"
                           class="form-control"
                           placeholder=""
                           formControlName="displayName"
                           role="textbox" />
                </div>
                <div class="form-group">
                    <div class="row">
                        <label for="url" class="col-sm-10">
                            <span>
                                <translate key="label.organization-url">Organization URL</translate>
                                <i class="fa fa-fw fa-asterisk text-danger" aria-hidden="true" *ngIf="hasValue$ | async"></i>
                            </span>
                        </label>
                        <span class="col-sm-2 text-right">
                            <ng-template #tooltipOrganizationURL>
                                <translate key="tooltip.organization-url">Organization URL popover</translate>
                            </ng-template>
                            <i class="info-icon fa fa-fw fa-info-circle text-primary fa-lg"
                               [ngbPopover]="tooltipOrganizationURL"
                               i18n-aria-label="@@tooltip.instruction"
                               aria-label="Information icon - press spacebar to read additional information for this form field"></i>
                        </span>
                    </div>
                    <input type="text"
                           id="url"
                           class="form-control"
                           placeholder=""
                           formControlName="url"
                           role="textbox" />
                </div>
            </div>
            <p class="text-danger" *ngIf="form.get('organization').hasError('org')" translate="message.organization-feedback">* These three fields must all be entered if any single field has a value.</p>
        </fieldset>
        <fieldset class="form-section col">
            <p>
                <translate key="label.contact-information">Contact Information:</translate>&nbsp;&nbsp;
                <button class="btn btn-success btn-sm" (click)="addContact()" translate="action.add-contacts" aria-label="Add contact to accordion group" role="button">
                    Add Contact
                </button>
            </p>
            <div formArrayName="contacts" class="bg-light border rounded p-4" *ngIf="contacts.length">
                <ul class="list-group" id="contactAccordionGroup" aria-label="Contact information accordion group" tabindex="0" role="presentation">
                    <li *ngFor="let contact of contacts.controls; let i=index;"
                        [formGroupName]="i"
                        class="list-group-item"
                        [attr.aria-label]="'Contact information accordion item for ' + contact.get('name').value"
                        #acc>
                        <div class="clearfix">
                            <div class="row" (click)="acc.isHidden = !acc.isHidden" (keydown.space)="acc.isHidden = !acc.isHidden" [id]="'contactAccordion' + i" aria-expanded="true" [attr.aria-controls]="'contactContent' + i" role="button">
                                <div class="col-sm-10">
                                    <i class="fa fa-fw" [ngClass]="{'fa-chevron-right': acc.isHidden, 'fa-chevron-down': !acc.isHidden}"></i>
                                    <span tabindex="0" role="heading" aria-level="3">
                                        {{ contact.get('name').value || 'New Contact' }}
                                        <small *ngIf="contact.get('type').value">({{ contact.get('type').value }})</small>
                                    </span>
                                </div>
                                <div class="col-sm-2 text-right">
                                    <button class="btn btn-link btn-sm text-danger" (click)="removeContact(i)" aria-label="Delete contact item" role="button">
                                        <i class="fa fa-fw fa-trash fa-lg"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                        <div class="collapse" [ngClass]="{'show': !acc.isHidden}" [id]="'contactContent' + i" [attr.aria-labelledby]="'contactAccordion' + i" role="region">
                            <hr />
                            <div class="row">
                                <div class="col col-7">
                                    <div class="form-group">
                                        <div class="row">
                                            <label [for]="'name-' + i" class="col-sm-9">
                                                <translate key="label.name">Name</translate>
                                            </label>
                                            <span class="col-sm-3 text-right">
                                                <ng-template #tooltipName>
                                                    <translate key="tooltip.name">Name popover</translate>
                                                </ng-template>
                                                <i class="info-icon fa fa-fw fa-info-circle text-primary fa-lg"
                                                   [ngbPopover]="tooltipName"
                                                   i18n-aria-label="@@tooltip.instruction"
                                                   aria-label="Information icon - press spacebar to read additional information for this form field"></i>
                                            </span>
                                        </div>
                                        <input [id]="'name' + i"
                                               type="text"
                                               class="form-control"
                                               placeholder=""
                                               formControlName="name"
                                               aria-label="Contact name"
                                               role="textbox" />
                                    </div>
                                </div>
                                <div class="col col-5">
                                    <div class="form-group">
                                        <div class="row">
                                            <label [for]="'type-' + i" class="col-sm-9">
                                                <translate key="label.type">Type</translate>
                                            </label>
                                            <span class="col-sm-3 text-right">
                                                <ng-template #tooltipType>
                                                    <translate key="tooltip.type">Type popover</translate>
                                                </ng-template>
                                                <i class="info-icon fa fa-fw fa-info-circle text-primary fa-lg"
                                                   [ngbPopover]="tooltipType"
                                                   i18n-aria-label="@@tooltip.instruction"
                                                   aria-label="Information icon - press spacebar to read additional information for this form field"></i>
                                            </span>
                                        </div>
                                        <select [id]="'type-' + i" class="form-control" formControlName="type" aria-label="Contact type dropdown" role="listbox">
                                            <option *ngFor="let opt of contactTypes; let i=index;" [value]="opt" [attr.aria-label]="opt" role="option">
                                                {{ opt }}
                                            </option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col">
                                    <div class="form-group">
                                        <div class="row">
                                            <label [for]="'email-' + i" class="col-sm-10">
                                                <translate key="label.email-address">Email Address</translate>
                                            </label>
                                            <span class="col-sm-2 text-right">
                                                <ng-template #tooltipEmailAddress>
                                                    <translate translate="tooltip.email-address">Email Address popover</translate>
                                                </ng-template>
                                            <i class="info-icon fa fa-fw fa-info-circle text-primary fa-lg"
                                               [ngbPopover]="tooltipEmailAddress"
                                               i18n-aria-label="@@tooltip.instruction"
                                               aria-label="Information icon - press spacebar to read additional information for this form field"></i>
                                            </span>
                                        </div>
                                        <input type="email"
                                               [id]="'email-' + i"
                                               class="form-control"
                                               placeholder=""
                                               formControlName="emailAddress"
                                               i18n-aria-label="label.contact-email-address"
                                               aria-label="Contact email address"
                                               role="textbox" />
                                        <small class="form-text text-danger" *ngIf="contact.get('emailAddress').touched && contact.get('emailAddress').hasError('email')">
                                            <translate key="message.valid-email">Must be a valid Email Address</translate>
                                        </small>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </li>
                </ul>
            </div>
        </fieldset>
    </div>
</form>
